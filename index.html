<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr. Jamieson's Science Arcade</title>
    <style>
        /* --- 80s FONTS & BASICS --- */
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Vibur&display=swap');

        body {
            background-color: #050011;
            color: #00f3ff;
            font-family: 'Courier New', monospace; /* Fallback */
            text-align: center;
            margin: 0;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* --- THE RETRO GRID BACKGROUND --- */
        .retro-grid {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1;
            background: 
                linear-gradient(transparent 0%, rgba(255, 0, 255, 0.4) 2%, transparent 3%),
                linear-gradient(90deg, transparent 0%, rgba(255, 0, 255, 0.4) 2%, transparent 3%);
            background-size: 50px 50px;
            transform: perspective(500px) rotateX(60deg) translateY(0);
            animation: gridMove 20s linear infinite;
            opacity: 0.3;
            bottom: -100px; /* Pull it down to create the 'floor' effect */
        }
        
        @keyframes gridMove {
            0% { transform: perspective(500px) rotateX(60deg) translateY(0); }
            100% { transform: perspective(500px) rotateX(60deg) translateY(50px); }
        }

        /* --- THE CRT SCREEN EFFECT --- */
        .crt::before {
            content: " ";
            display: block;
            position: fixed;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 2;
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        /* --- NEON TITLE --- */
        h1 {
            font-family: 'Press Start 2P', cursive; /* Arcade Font */
            color: #fff;
            text-transform: uppercase;
            font-size: 2.5rem; /* Slightly smaller for mobile safety */
            line-height: 1.5;
            margin-top: 40px;
            text-shadow: 
                0 0 5px #fff,
                0 0 10px #fff,
                0 0 20px #ff00de,
                0 0 30px #ff00de,
                0 0 40px #ff00de;
            animation: pulsate 1.5s infinite alternate;
        }

        @keyframes pulsate {
            100% {
                text-shadow:
                0 0 4px #fff,
                0 0 11px #fff,
                0 0 19px #ff00de,
                0 0 40px #ff00de,
                0 0 80px #ff00de;
            }
            0% {
                text-shadow:
                0 0 2px #fff,
                0 0 4px #fff,
                0 0 6px #ff00de,
                0 0 10px #ff00de,
                0 0 45px #ff00de;
            }
        }
        
        /* The Status Text Style */
        p.instructions {
            color: #00f3ff;
            font-family: 'Vibur', cursive; /* Neon script font */
            margin-bottom: 30px;
            font-size: 2rem;
            text-shadow: 0 0 10px #00f3ff;
            min-height: 1.5em;
        }

        .blink {
            animation: blinker 0.2s linear infinite; /* Fast 80s glitch blink */
        }
        @keyframes blinker {
            50% { opacity: 0; }
        }

        .arcade-container {
            padding: 20px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 30px;
            position: relative;
            z-index: 1; /* Above the grid */
        }

        /* --- THE CARTRIDGES --- */
        .game-card {
            border: 2px solid #ff00de;
            width: 200px;
            padding: 15px;
            cursor: pointer;
            transition: 0.3s;
            position: relative;
            background: rgba(0, 0, 0, 0.7);
            color: #ff00de;
            pointer-events: none;
            box-shadow: 0 0 10px #ff00de, inset 0 0 10px #ff00de;
            clip-path: polygon(10% 0, 100% 0, 100% 90%, 90% 100%, 0 100%, 0 10%); /* Sci-fi corner cut */
        }

        .game-card h3 {
            font-family: 'Press Start 2P', cursive;
            font-size: 0.8rem;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        /* READY TO PLAY */
        .game-card.status-online {
            border-color: #00f3ff;
            color: #00f3ff;
            box-shadow: 0 0 15px #00f3ff, inset 0 0 15px #00f3ff;
            pointer-events: auto;
        }
        .game-card.status-online:hover {
            background-color: rgba(0, 243, 255, 0.2);
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 0 30px #00f3ff, inset 0 0 20px #00f3ff;
        }

        /* MISSING CARTRIDGE */
        .game-card.status-offline {
            border-color: #333;
            color: #555;
            box-shadow: none;
            pointer-events: auto; /* Allow clicking to show alert */
        }
        
        .status-text {
            font-size: 0.8rem;
            margin-top: 10px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        /* --- MODAL STUFF --- */
        #gameModal {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: #000;
            z-index: 1000;
            flex-direction: column;
        }

        #closeBtn {
            align-self: center;
            margin: 10px;
            padding: 10px 40px;
            background: #ff00de;
            color: #fff;
            border: none;
            font-family: 'Press Start 2P', cursive;
            font-size: 1rem;
            cursor: pointer;
            box-shadow: 0 0 10px #ff00de;
            text-transform: uppercase;
        }
        
        #closeBtn:hover {
            background: #fff;
            color: #ff00de;
            box-shadow: 0 0 20px #fff;
        }

        iframe {
            flex-grow: 1;
            width: 100%;
            border: none;
        }

        /* --- SPLASH SCREEN --- */
        #splash-screen {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-color: #050011;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: opacity 1s ease-out;
        }
        
        #start-btn {
            background: transparent;
            color: #00f3ff;
            border: 4px solid #00f3ff;
            padding: 20px 40px;
            font-family: 'Press Start 2P', cursive;
            font-size: 1.5rem;
            cursor: pointer;
            text-transform: uppercase;
            box-shadow: 0 0 20px #00f3ff, inset 0 0 20px #00f3ff;
            animation: blinker 1s linear infinite;
            margin-top: 50px;
        }
        
        #start-btn:hover {
            background: #00f3ff;
            color: #000;
        }

    </style>
</head>
<body class="crt">

    <!-- AUDIO PLAYER -->
    <audio id="bg-music" loop>
        <source src="stranger-things-124008.mp3" type="audio/mpeg">
    </audio>

    <!-- SPLASH SCREEN -->
    <div id="splash-screen">
        <h1>Mr. Jamieson's<br>Science Arcade</h1>
        <button id="start-btn">INSERT COIN TO START</button>
    </div>

    <div class="retro-grid"></div>

    <h1>Mr. Jamieson's<br>Science Arcade</h1>
    
    <!-- This is the text that will change -->
    <p class="instructions blink">SYSTEM INITIALIZING...</p>

    <div class="arcade-container">

        <!-- Ehaan -->
        <div class="game-card" data-url="./Ehaan/index.html">
            <h3>Ehaan</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Viaan -->
        <div class="game-card" data-url="./Viaan/index.html">
            <h3>Viaan</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Maya -->
        <div class="game-card" data-url="./Maya/index.html">
            <h3>Maya</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Bashir -->
        <div class="game-card" data-url="./Bashir/index.html">
            <h3>Bashir</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Mohamed -->
        <div class="game-card" data-url="./Mohamed/index.html">
            <h3>Mohamed</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Basid -->
        <div class="game-card" data-url="./Basid/index.html">
            <h3>Basid</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Skylar -->
        <div class="game-card" data-url="./Skylar/index.html">
            <h3>Skylar</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Trisha -->
        <div class="game-card" data-url="./Trisha/index.html">
            <h3>Trisha</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Delisha -->
        <div class="game-card" data-url="./Delisha/index.html">
            <h3>Delisha</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Ayat -->
        <div class="game-card" data-url="./Ayat/index.html">
            <h3>Ayat</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Muhannad -->
        <div class="game-card" data-url="./Muhannad/index.html">
            <h3>Muhannad</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Zayn -->
        <div class="game-card" data-url="./Zayn/index.html">
            <h3>Zayn</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Adrian -->
        <div class="game-card" data-url="./Adrian/index.html">
            <h3>Adrian</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Harmony -->
        <div class="game-card" data-url="./Harmony/index.html">
            <h3>Harmony</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Hamnah -->
        <div class="game-card" data-url="./Hamnah/index.html">
            <h3>Hamnah</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Ayda -->
        <div class="game-card" data-url="./Ayda/index.html">
            <h3>Ayda</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Hadi -->
        <div class="game-card" data-url="./Hadi/index.html">
            <h3>Hadi</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Zoya -->
        <div class="game-card" data-url="./Zoya/index.html">
            <h3>Zoya</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Munachi -->
        <div class="game-card" data-url="./Munachi/index.html">
            <h3>Munachi</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Ellen -->
        <div class="game-card" data-url="./Ellen/index.html">
            <h3>Ellen</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Ameer -->
        <div class="game-card" data-url="./Ameer/index.html">
            <h3>Ameer</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Mustafa -->
        <div class="game-card" data-url="./Mustafa/index.html">
            <h3>Mustafa</h3>
            <div class="status-text">Scanning...</div>
        </div>

        <!-- Aimen -->
        <div class="game-card" data-url="./Aimen/index.html">
            <h3>Aimen</h3>
            <div class="status-text">Scanning...</div>
        </div>

    </div>

    <!-- THE POP UP WINDOW -->
    <div id="gameModal">
        <button id="closeBtn" onclick="closeGame()">EXIT GAME</button>
        <iframe id="gameFrame" src=""></iframe>
    </div>

    <script>
        const bgMusic = document.getElementById('bg-music');
        const splashScreen = document.getElementById('splash-screen');
        const startBtn = document.getElementById('start-btn');
        let musicStarted = false;

        // --- SPLASH SCREEN LOGIC ---
        startBtn.addEventListener('click', () => {
            // Fade out splash
            splashScreen.style.opacity = '0';
            setTimeout(() => {
                splashScreen.style.display = 'none';
            }, 1000);
            
            // Start Music
            bgMusic.volume = 0.5; // Set volume to 50%
            bgMusic.play().then(() => {
                musicStarted = true;
            }).catch(e => console.log("Audio play failed: ", e));
            
            // Start Scanning
            startScanning();
        });

        // --- SCANNING LOGIC (Wrapped in function) ---
        function startScanning() {
            const cards = document.querySelectorAll('.game-card');
            const instructionsText = document.querySelector('.instructions');

            // Map each card to a Promise so we can wait for ALL of them to finish
            const scanPromises = Array.from(cards).map(async (card) => {
                const url = card.getAttribute('data-url');
                const statusLabel = card.querySelector('.status-text');

                // Artificial delay for "retro scanning" effect (1s to 3s)
                const randomDelay = Math.random() * 2000 + 1000;
                await new Promise(r => setTimeout(r, randomDelay));

                try {
                    // Fetch the file content with timestamp to prevent caching
                    const response = await fetch(url + '?t=' + new Date().getTime());
                    
                    if (response.ok) {
                        const text = await response.text();

                        if (text.includes("SYSTEM OFFLINE")) {
                            // It's the placeholder
                            card.classList.add('status-offline');
                            statusLabel.innerText = "MISSING";
                            card.onclick = () => alert("This student has not uploaded their game yet.");
                        } else {
                            // It's a real game
                            card.classList.add('status-online');
                            statusLabel.innerText = "READY";
                            card.onclick = () => openGame(url);
                        }
                    } else {
                        // File not found (treat as missing)
                        card.classList.add('status-offline');
                        statusLabel.innerText = "MISSING";
                        card.onclick = () => alert("This student has not uploaded their game yet.");
                    }
                } catch (error) {
                    // Network error (treat as missing)
                    card.classList.add('status-offline');
                    statusLabel.innerText = "MISSING";
                    card.onclick = () => alert("This student has not uploaded their game yet.");
                }
            });

            // Wait for all scanners to report back
            Promise.all(scanPromises).then(() => {
                // UPDATE THE TEXT AT THE TOP
                instructionsText.innerText = "INSERT COIN";
                instructionsText.classList.remove('blink');
                // Make the text blink slowly now that it is ready
                instructionsText.style.animation = "blinker 1.5s linear infinite"; 
                instructionsText.style.color = "#00f3ff";
                instructionsText.style.textShadow = "0 0 10px #00f3ff, 0 0 20px #00f3ff";
            });
        }

        // MODAL LOGIC
        const modal = document.getElementById('gameModal');
        const frame = document.getElementById('gameFrame');

        function openGame(path) {
            // PAUSE MUSIC
            if (musicStarted) bgMusic.pause();

            modal.style.display = 'flex';
            frame.src = path;
            setTimeout(() => { frame.contentWindow.focus(); }, 500);
        }

        function closeGame() {
            // RESUME MUSIC
            if (musicStarted) bgMusic.play();

            modal.style.display = 'none';
            frame.src = '';
        }
    </script>

</body>
</html>
